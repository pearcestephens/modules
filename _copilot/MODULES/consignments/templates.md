# Consignments Module - Templates

## Overview  
Template component structure and UI patterns for the Consignments module.

**Last Updated:** 2025-10-12 07:00 UTC

## Template Hierarchy

### Base → Module → Page Pattern
```
Base Layout (CIS Template)
├── Module Layout (Consignments)
    ├── Pack Page
    ├── Receive Page
    └── Hub Page
```

## UI Components

### Modal Templates
| Component | File | Bootstrap | Purpose |
|-----------|------|-----------|---------|
| Add Products Modal | `pack/add_products_modal.php` | BS4 Modal | Product selection interface |
| Validation Modal | `receive/validation_modal.php` | BS4 Modal | Receive validation dialog |
| Confirmation Modal | `shared/confirmation_modal.php` | BS4 Modal | Action confirmations |

### Form Templates
| Component | File | Framework | Purpose |
|-----------|------|-----------|---------|
| Pack Form | `pack/pack_form.php` | BS4 Forms | Pack operation form |
| Receive Form | `receive/receive_form.php` | BS4 Forms | Receive operation form |
| Search Form | `shared/search_form.php` | BS4 Forms | Product search interface |

### Table Templates
| Component | File | Features | Purpose |
|-----------|------|----------|---------|
| Pack Lines Table | `pack/pack_lines_table.php` | Sortable, Editable | Pack line items display |
| Receive Lines Table | `receive/receive_lines_table.php` | Validation, Editable | Receive line items display |
| Transfer History | `hub/history_table.php` | Paginated, Filterable | Transfer history view |

### Action Templates
| Component | File | Actions | Purpose |
|-----------|------|---------|---------|
| Pack Footer | `pack/action_footer_pack.php` | Submit, Cancel, Save | Pack action buttons |
| Receive Footer | `receive/action_footer_receive.php` | Submit, Reject, Partial | Receive action buttons |
| Hub Actions | `hub/action_buttons.php` | Create, Search, Filter | Hub action buttons |

## Template Slots and Data

### Pack Template Data
```php
$packData = [
    'transfer_id' => 123,
    'from_outlet' => [...],
    'to_outlet' => [...],
    'lines' => [
        ['product_id' => 1, 'sku' => 'ABC123', 'qty_requested' => 10, ...],
        // ...
    ],
    'status' => 'draft',
    'locked_by' => null,
    'created_at' => '2025-10-12 07:00:00'
];
```

### Receive Template Data  
```php
$receiveData = [
    'transfer_id' => 123,
    'packed_lines' => [...],
    'received_lines' => [...],
    'discrepancies' => [...],
    'status' => 'pending_receive',
    'packed_at' => '2025-10-12 06:00:00'
];
```

## CSS Framework Integration

### Bootstrap 4 Components Used
- **Cards:** `.card`, `.card-header`, `.card-body`
- **Tables:** `.table`, `.table-striped`, `.table-sm`
- **Forms:** `.form-group`, `.form-control`, `.input-group`
- **Buttons:** `.btn`, `.btn-primary`, `.btn-outline-secondary`
- **Modals:** `.modal`, `.modal-lg`, `.modal-dialog`
- **Alerts:** `.alert`, `.alert-info`, `.alert-danger`

### Custom CSS Classes
- **Module:** `.consignments-*`
- **Pack:** `.pack-*` 
- **Receive:** `.receive-*`
- **Transfer:** `.transfer-*`

## JavaScript Integration

### Template Event Binding
```javascript
// Pack template events
$('.pack-line-qty').on('input', updateLineQuantity);
$('.pack-submit-btn').on('click', submitPack);

// Receive template events  
$('.receive-line-qty').on('input', validateReceiveQuantity);
$('.receive-submit-btn').on('click', submitReceive);
```

### AJAX Form Handling
Templates include CSRF tokens and use standardized AJAX submission:
```php
<input type="hidden" name="csrf_token" value="<?= $_SESSION['csrf_token'] ?>">
```

## Responsive Behavior

### Mobile Adaptations
- Tables collapse to cards on mobile
- Modals use full-screen on small devices
- Action buttons stack vertically
- Form inputs use appropriate mobile types

### Tablet Adaptations
- Sidebar collapses to overlay
- Tables maintain structure with horizontal scroll
- Modals use medium size

## Accessibility Features
- **ARIA Labels:** All form controls labeled
- **Keyboard Navigation:** Tab order optimized
- **Screen Reader:** Semantic HTML structure
- **Color Contrast:** WCAG 2.1 AA compliant
- **Focus Management:** Modal focus handling

## Template Security
- **XSS Prevention:** All dynamic content escaped
- **CSRF Protection:** Forms include tokens
- **Input Validation:** Client and server-side
- **Permission Checks:** Template content filtered by user role

---
*Generated by CIS Knowledge Base System*
