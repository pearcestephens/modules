/* ==========================================================================
   Pack Pro v6 â€” TURBO-MEGA (Bright, Pro, Feature-Rich)
   - Multi-theme support via data-theme on .pack-pro
   - Density modes via [data-density="cozy|compact"]
   - Sticky table header, skeleton loaders, hover previews
   - Rich utilities: shadows, radii, borders, text, spacing helpers
   - Dark mode + print + reduced motion
   ========================================================================== */

/* ---------- Base Tokens -------------------------------------------------- */
:root{
  /* Brand (default: Violet + Aqua) */
  --brand:        #6C5CE7;
  --brand-acc:    #00D4FF;

  /* Neutrals */
  --ink:          #111827;
  --ink-2:        #1f2937;
  --muted:        #6b7280;
  --muted-2:      #8b92a8;

  /* Backgrounds */
  --bg-page:      #f7f8fb;
  --bg-card:      #ffffff;
  --bg-soft:      #f1f4f8;

  /* States */
  --success:      #22c55e;
  --success-ink:  #14532d;
  --success-bg:   #e8f8ee;

  --warn:         #f59e0b;
  --warn-ink:     #7a3e00;
  --warn-bg:      #fff4db;

  --danger:       #ef4444;
  --danger-ink:   #7f1d1d;
  --danger-bg:    #ffe5e7;

  /* Frame */
  --border:       #e7ebf2;
  --border-2:     #dfe6ee;

  /* Radii & Shadows */
  --radius-xs: 6px; --radius-sm: 8px; --radius-md: 12px; --radius-lg: 18px; --radius-pill: 999px;
  --shadow-xs: 0 1px 2px rgba(16,24,40,.06);
  --shadow-sm: 0 2px 6px rgba(16,24,40,.08);
  --shadow-md: 0 10px 24px rgba(16,24,40,.12);
  --shadow-lg: 0 18px 36px rgba(16,24,40,.18);

  /* Focus */
  --ring: 0 0 0 3px rgba(0,212,255,.20);

  /* Table */
  --table-head-bg: #f1f4f8;
  --table-row-hover: #fafcff;

  /* Gradients */
  --grad-1: linear-gradient(135deg, var(--brand) 0%, var(--brand-acc) 100%);
  --grad-ghost: linear-gradient(135deg, rgba(108,92,231,.16) 0%, rgba(0,212,255,.16) 100%);

  /* Z */
  --z-previewer: 9999;
  --z-toast:     99999;
}

/* ---------- Optional Theme Variants ------------------------------------- */
.pack-pro[data-theme="ocean"]{
  --brand: #0ea5e9; --brand-acc:#22d3ee;
}
.pack-pro[data-theme="citrus"]{
  --brand: #f59e0b; --brand-acc:#f97316;
}
.pack-pro[data-theme="magenta"]{
  --brand: #d946ef; --brand-acc:#f472b6;
}
.pack-pro[data-theme="emerald"]{
  --brand: #10b981; --brand-acc:#34d399;
}

/* ---------- Page Shell --------------------------------------------------- */
.pack-pro{ background: var(--bg-page); color: var(--ink); font-size: 14px; }
.pack-pro a{ color: var(--brand); }
.pack-pro .card{ background: var(--bg-card); border:1px solid var(--border); border-radius:var(--radius-md); box-shadow: var(--shadow-xs); }
.pack-pro .card-header{ background:#fff; border-bottom:1px solid var(--border); border-radius:var(--radius-md) var(--radius-md) 0 0; }
.pack-pro :focus-visible { outline: none; box-shadow: var(--ring); border-radius: 10px; }
.pack-pro .gap-2 > * + * { margin-left: .5rem; }

/* Density overrides */
.pack-pro[data-density="compact"]{ font-size: 13px; }
.pack-pro[data-density="compact"] .form-control-sm{ padding:.15rem .4rem; }
.pack-pro[data-density="compact"] .btn{ padding:.25rem .45rem; font-size: .85rem; }

/* ---------- Top Actions / Hero Search ----------------------------------- */
.pro-actions{ position: sticky; top: 0; z-index: 10; background: var(--bg-page); padding: 6px 0; }
.pro-actions .hero-search{
  position: relative; display:flex; align-items:center;
  width: min(820px, 62vw); background:#fff; border:1px solid var(--border);
  border-radius: var(--radius-pill); padding: 8px 14px; box-shadow: var(--shadow-sm);
}
.pro-actions .hero-search i{ color: var(--brand); font-size: 18px; margin-right: 8px; }
.pro-actions .hero-search input{
  border:0!important; outline:0!important; box-shadow:none!important;
  font-size: 15px; background: transparent; padding-left: 0; width:100%;
}
#productResults{
  max-height: 400px; overflow:auto; width:100%; transform: translateY(8px);
  border-radius: var(--radius-lg); box-shadow: var(--shadow-md); border:1px solid var(--border-2);
}
#productResults .dropdown-item.item{ display:flex; align-items:center; gap:10px; padding:.5rem .75rem; }
#productResults .dropdown-item.item.disabled{ opacity:.45; pointer-events:none; }
#productResults .res-thumb{ width:30px;height:30px;border-radius:8px;object-fit:cover }
#productResults .dropdown-item.item.active{ background: var(--table-row-hover); }

/* Gradient CTA */
.btn-gradient-primary{ color:#fff!important; border:0; background: var(--grad-1); box-shadow: 0 8px 18px rgba(108,92,231,.22);}
.btn-gradient-primary:hover{ filter: brightness(1.06); }
.btn-gradient-secondary{ color:#0f172a!important; background:#fff; border:1px solid var(--border); }
.btn-gradient-secondary:hover{ background:#f9fafb; }

/* ---------- Transfer Banner & KPIs -------------------------------------- */
.pro-banner .pb-title{ font-size: 18px; font-weight: 800; color: var(--ink); }
.pro-banner .pb-number{ color: var(--brand); }
.pro-banner .pb-dest, .pro-banner .pb-time{ color: #58607a; }
.pro-banner .badge-state{
  background: rgba(108,92,231,.1); color: var(--brand);
  border:1px solid rgba(108,92,231,.25); border-radius: var(--radius-pill); padding: 3px 8px;
}
.pb-kpis{ display:flex; align-items:center; gap: 6px; }
.pb-kpis .kpi{ padding:6px 12px; text-align:center; background:#fff; border:1px solid var(--border-2); border-radius: var(--radius-sm); }
.pb-kpis .k{ font-size:11px; color:#8b92a8; letter-spacing:.08em; text-transform:uppercase; }
.pb-kpis .v{ font-size:16px; font-weight:700; color: var(--ink-2); }
.pb-kpis .kpi.wide{ min-width:170px; }
.progress.progress-xs{ height: 6px; margin-top: 4px; }
.progress-bar{ background: var(--grad-1); }

/* ---------- Main Grid ---------------------------------------------------- */
.pack-pro .grid{ display:grid; grid-template-columns: 1fr 400px; grid-gap: 14px; }
@media (max-width: 1200px){ .pack-pro .grid{ grid-template-columns: 1fr; } }

/* ---------- Products Table ---------------------------------------------- */
.table-wrap{ overflow:auto; }
#transferTable{ width:100%; border-collapse: separate; border-spacing: 0; }
#transferTable thead th{
  position: sticky; top: 0; z-index: 2;
  font-weight:600; font-size:12px; color:#728096; background: var(--table-head-bg);
  border-bottom:1px solid var(--border); white-space:nowrap;
}
#transferTable tbody tr:hover{ background: var(--table-row-hover); }
#transferTable .td-img .thumb{ width:40px;height:40px;border-radius:8px;object-fit:cover }
#transferTable .td-name .prod{ font-weight: 600; color: var(--ink-2); }
#transferTable .sku-mono{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  font-size:12px; color:#8b92a8;
}
#transferTable .badge-plan{ background:#eef2ff; color:#3949ab; padding:.25rem .45rem; border-radius:6px; }

/* Row states */
#transferTable tbody tr{ transition: background-color .2s ease; }
#transferTable tbody tr.row-ok    { background: var(--success-bg); }
#transferTable tbody tr.row-under { background: var(--warn-bg); }
#transferTable tbody tr.row-over  { background: var(--danger-bg); }
#transferTable tbody tr.row-zero  { background: #fff; }
#transferTable tbody tr.row-ok    td{ border-left:4px solid var(--success); }
#transferTable tbody tr.row-under td{ border-left:4px solid var(--warn); }
#transferTable tbody tr.row-over  td{ border-left:4px solid var(--danger); }

/* Inputs (compact) */
#transferTable input.counted, input.counted-qty{
  height: 28px !important; padding: 2px 6px !important; font-size: 14px !important; line-height: 1.4 !important;
}
input.counted-qty::-webkit-outer-spin-button,
input.counted-qty::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
input.counted-qty[type=number] { -moz-appearance: textfield; appearance: textfield; }

/* Hover previewer */
.img-preview{
  position:absolute; display:none; pointer-events:none; z-index:var(--z-previewer);
  background:#fff; border:1px solid var(--border-2); border-radius:10px; padding:6px; box-shadow: var(--shadow-lg);
}
.img-preview img{ width:220px; height:auto; display:block; border-radius:8px; }
#transferTable tbody tr td img{ transition: transform .12s ease; cursor: pointer; }
#transferTable tbody tr td img.no-zoom{ cursor: default; }

/* ---------- Notes Row ---------------------------------------------------- */
.note-row{ background:#f9fafb; border-top: 1px solid var(--border); padding:.65rem .75rem; }

/* ---------- Freight Console --------------------------------------------- */
.freight-card .freight-head{
  background:#fff; border-bottom:1px solid var(--border);
  display:flex; align-items:center; justify-content:space-between;
}
.boxes-stepper{ display:flex; align-items:center; gap:8px; }
.boxes-stepper .btn-step{
  padding:0 .65rem; height:30px; line-height:28px; border-radius:10px; border:1px solid #e4e7ed; background:#fff;
}
.boxes-stepper .btn-step:hover{ background:#f6f8fb; }
.boxes-stepper .box-pill{
  min-width:48px; text-align:center; font-weight:800; color: var(--brand);
  background: rgba(108,92,231,.08); border:1px solid rgba(108,92,231,.2);
  padding:4px 10px; border-radius:var(--radius-pill);
}

/* Pills -> tab look */
.nav-pills .nav-link{ border-radius:12px; padding:.35rem .7rem; color:#6b7280; }
.nav-pills .nav-link.active{
  color:#111827; background: var(--grad-ghost);
  border:1px solid rgba(108,92,231,.25);
}

/* Tracking list (dense) */
.list-group-sm .list-group-item{
  padding:.35rem .5rem; font-size: 12.5px; display:flex; align-items:center; justify-content:space-between;
}
.text-mono{ font-family: ui-monospace, Menlo, Consolas, "Courier New", monospace; }
.list-group-sm .btn-remove{
  border:0; background: transparent; font-size: 16px; line-height: 1; color:#9aa3b1; padding:0 .25rem;
}
.list-group-sm .btn-remove:hover{ color: var(--danger); }

/* ---------- Insights (with skeleton) ------------------------------------ */
#freightInsights .skeleton{
  height: 10px; border-radius: 6px; background: linear-gradient(90deg,#eef1f5 0%,#f6f8fb 40%,#eef1f5 80%); background-size:200% 100%;
  animation: sk-wave 1.4s linear infinite;
}
#freightInsights .skeleton + .skeleton{ margin-top:8px; }
@keyframes sk-wave{ 0%{background-position:0 0}100%{background-position:200% 0} }

/* ---------- History ------------------------------------------------------ */
.history-item{ display:flex; gap:10px; padding:6px 0; }
.history-item .avatar{
  width:28px;height:28px;border-radius:50%; background:#eef2ff; color:#3949ab;
  display:flex; align-items:center; justify-content:center; font-weight:700;
}
.history-item .meta{ font-size:12px; color:#7a8092; }

/* ---------- Upload Modal (SSE) ------------------------------------------ */
#uploadProgressModal .modal-content{ border-radius: 14px; overflow:hidden; }
#uploadProgressModal .modal-header{ background: var(--grad-1); color:#fff; }
#uploadProgressModal .modal-header .modal-title{ font-weight:700; }
#uploadProgressModal .progress{ height: 10px; border-radius: var(--radius-pill); background:#eef1f5; }
#uploadProgressModal .progress .progress-bar{
  background: var(--grad-1); background-size: 200% 100%; animation: shimmer 2.6s linear infinite;
}
@keyframes shimmer { 0% {background-position: 0 0;} 100% {background-position: 200% 0;} }
#uploadLog{ max-height:180px; overflow:auto; }
#uploadLog li{ padding:4px 0; }

/* ---------- Auto-save + Network toasts ---------------------------------- */
.auto-save-toast, .net-toast{
  position: fixed; left: 50%; transform: translateX(-50%);
  top: 12px; background:#111; color:#fff; padding: 6px 10px; border-radius: 10px;
  font-size: 12px; opacity: .92; z-index: var(--z-toast); box-shadow: var(--shadow-md);
}

/* ---------- Animations you shipped (curated) ----------------------------- */
#autosave-indicator{ transition: all .4s cubic-bezier(.4,0,.2,1); cursor: default; }
#autosave-indicator .save-icon i{ transition: all .3s cubic-bezier(.4,0,.2,1); }
#autosave-indicator .save-status{ transition: color .3s ease; }
@keyframes pulse-glow{ 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:.7;transform:scale(1.08)} }
@keyframes success-bounce{ 0%{transform:scale(1)}30%{transform:scale(1.3)}50%{transform:scale(.95)}70%{transform:scale(1.08)}100%{transform:scale(1)} }
@keyframes ripple{ 0%{ box-shadow:0 0 0 0 rgba(40,167,69,.5)}50%{ box-shadow:0 0 0 10px rgba(40,167,69,0)}100%{ box-shadow:0 0 0 0 rgba(40,167,69,0)} }
#autosave-indicator.saved-ripple{ animation: ripple .6s ease-out; }
.connection-dot{ width:8px;height:8px;border-radius:50%;background:#4cd964; animation: pulse-dot 2s ease-in-out infinite; }
@keyframes pulse-dot{ 0%,100%{opacity:1; box-shadow:0 0 8px rgba(76,217,100,.5)} 50%{opacity:.5; box-shadow:0 0 12px rgba(76,217,100,.8)} }

/* ---------- Utilities (lots, on purpose) -------------------------------- */
/* Radii */
.u-radius-xs{ border-radius: var(--radius-xs)!important; }
.u-radius-sm{ border-radius: var(--radius-sm)!important; }
.u-radius-md{ border-radius: var(--radius-md)!important; }
.u-radius-lg{ border-radius: var(--radius-lg)!important; }
.u-radius-pill{ border-radius: var(--radius-pill)!important; }

/* Shadows */
.u-shadow-xs{ box-shadow: var(--shadow-xs)!important; }
.u-shadow-sm{ box-shadow: var(--shadow-sm)!important; }
.u-shadow-md{ box-shadow: var(--shadow-md)!important; }
.u-shadow-lg{ box-shadow: var(--shadow-lg)!important; }

/* Borders */
.u-border{ border:1px solid var(--border)!important; }
.u-border-2{ border:1px solid var(--border-2)!important; }
.u-border-0{ border:0!important; }

/* Text + Truncation */
.u-muted{ color: var(--muted)!important; }
.u-ink{ color: var(--ink)!important; }
.u-ellipsis{ white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* Spacing helpers (minimal set) */
.u-mb-0{ margin-bottom:0!important; } .u-mb-1{ margin-bottom:.25rem!important; } .u-mb-2{ margin-bottom:.5rem!important; }
.u-mt-0{ margin-top:0!important; } .u-mt-1{ margin-top:.25rem!important; } .u-mt-2{ margin-top:.5rem!important; }
.u-p-0{ padding:0!important; } .u-p-1{ padding:.25rem!important; } .u-p-2{ padding:.5rem!important; } .u-p-3{ padding:1rem!important; }

/* Badges */
.badge-soft{ background:#eef2ff; color:#3949ab; border:1px solid #dfe3ff; border-radius:8px; padding:2px 6px; }

/* Buttons */
.btn-ghost{
  background:transparent; border:1px dashed var(--border); color:var(--muted);
}
.btn-ghost:hover{ background:#fafcff; }

/* Flex helpers */
.u-flex{ display:flex!important; } .u-inline-flex{ display:inline-flex!important; }
.u-center{ justify-content:center!important; align-items:center!important; }
.u-between{ justify-content:space-between!important; }

/* Widths */
.u-w-100{ width:100%!important; } .u-w-50{ width:50%!important; } .u-w-33{ width:33.333%!important; }

/* Z helpers */
.u-z-1{ z-index:1!important; } .u-z-10{ z-index:10!important; } .u-z-100{ z-index:100!important; }

/* ---------- Dark Mode (opt-in) ------------------------------------------ */
@media (prefers-color-scheme: dark){
  .pack-pro[data-dark="auto"]{
    --bg-page: #0b1020;
    --bg-card: #0f1426;
    --bg-soft: #0b1222;
    --ink: #e5e7eb;
    --ink-2: #f3f4f6;
    --muted: #9ca3af;
    --border: #1d2336;
    --border-2:#2a3352;
    --table-head-bg:#0f172a;
    --table-row-hover:#0d1324;
    --success-bg:#052f1c; --warn-bg:#2f2405; --danger-bg:#2a0d10;
  }
}

/* ---------- Print -------------------------------------------------------- */
@media print{
  .pro-actions, .grid-right, #uploadProgressModal{ display:none !important; }
  #transferTable thead th{ position: static!important; }
  .card, .pro-banner{ border:0; box-shadow:none; }
}

/* ---------- Reduced Motion ---------------------------------------------- */
@media (prefers-reduced-motion: reduce){
  *{ animation: none !important; transition: none !important; }
}

/* ---------- High DPI tweaks --------------------------------------------- */
@media (min-resolution: 2dppx){
  #productResults .res-thumb{ image-rendering: -webkit-optimize-contrast; }
}
